{"version":3,"sources":["webpack:///app.js","webpack:///./src/index.js","webpack:///./src/store.js","webpack:///./src/utils.js","webpack:///./src/vision.js","webpack:///./assets/map/map.js","webpack:///./src/input.js","webpack:///./src/loader.js","webpack:///./src/movement.js"],"names":["webpackJsonp","module","exports","__webpack_require__","create","_loaderJs","mainLoad","_storeJs","state","game","Phaser","Game","AUTO","Object","defineProperty","value","position","direction","loadingVision","window","s","randInt","x","Math","floor","random","equalArrays","a1","a2","equal","i","textToPos","t","split","map","parseInt","posToText","pos","join","posDirToText","posDist","p1","p2","sqrt","pow","rotLeft","dir","directions","indexOf","rotRight","rot180","getBounds","obj","y","width","height","setVision","isResize","arguments","length","undefined","img","destroy","add","image","_utilsJs","r","min","scale","setTo","bounds","key","round","onTap","inputEnabled","events","onInputUp","this","loadVision","cache","checkImageKey","load","onFileComplete","start","resize","setGameSize","innerWidth","innerHeight","addEventListener","time","1_2_0","1_1_0","n","1_0_0","w","0_0_0","e","initKeyboardInput","fMove","fInteract","_this","cursors","input","keyboard","addKey","Keyboard","onDown","SPACEBAR","initMouseInput","manager","pointer","p","_getBounds","_getBounds2","_slicedToArray","ix","iy","iw","ih","ty","by","lx","rx","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","TypeError","onLoadComplete","removeAll","mainInit","firstImg","console","log","stage","backgroundColor","_inputJs","_movementJs","move","_visionJs","_interopRequireDefault","__esModule","default","tryChangePos","newPos","_assetsMapMapJs2","event","moved","rotated","rotatePlayer","onMoved","type","_assetsMapMapJs"],"mappings":"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","file":"app.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */\n/*!**********************!*\\\n  !*** ./src/index.js ***!\n  \\**********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _loaderJs = __webpack_require__(/*! ./loader.js */ 24);\n\t\n\tvar _storeJs = __webpack_require__(/*! ./store.js */ 3);\n\t\n\tfunction create() {\n\t    (0, _loaderJs.mainLoad)();\n\t}\n\t\n\t_storeJs.state.game = new Phaser.Game(0, 0, Phaser.AUTO, 'app', { create: create });\n\n/***/ },\n/* 1 */,\n/* 2 */,\n/* 3 */\n/*!**********************!*\\\n  !*** ./src/store.js ***!\n  \\**********************/\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\tvar state = {\n\t    position: [1, 2, 0],\n\t    direction: 'w',\n\t    // if is waiting the load of an image for the vision\n\t    loadingVision: false\n\t};\n\t\n\texports.state = state;\n\twindow.s = state;\n\n/***/ },\n/* 4 */,\n/* 5 */,\n/* 6 */\n/*!**********************!*\\\n  !*** ./src/utils.js ***!\n  \\**********************/\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\texports.randInt = randInt;\n\texports.equalArrays = equalArrays;\n\texports.textToPos = textToPos;\n\texports.posToText = posToText;\n\texports.posDirToText = posDirToText;\n\texports.posDist = posDist;\n\texports.rotLeft = rotLeft;\n\texports.rotRight = rotRight;\n\texports.rot180 = rot180;\n\texports.getBounds = getBounds;\n\tvar directions = ['n', 'e', 's', 'w'];\n\t\n\t// Return a random int from 0 to x-1\n\t\n\tfunction randInt(x) {\n\t    return Math.floor(Math.random() * x);\n\t}\n\t\n\t// Check if two arrays have the same numbers in the same order\n\t\n\tfunction equalArrays(a1, a2) {\n\t    var equal = true;\n\t    for (var i in a1) {\n\t        if (a1[i] != a2[i]) {\n\t            equal = false;\n\t            break;\n\t        }\n\t    }\n\t    return equal;\n\t}\n\t\n\t// Converts a text to a position. e.g.: '2_4_5' -> [2,4,5]\n\t\n\tfunction textToPos(t) {\n\t    return t.split('_').map(function (x) {\n\t        return parseInt(x);\n\t    });\n\t}\n\t\n\t// Converts a position to text. e.g.: [2,4,5] -> '2_4_5'\n\t\n\tfunction posToText(pos) {\n\t    return pos.join('_');\n\t}\n\t\n\t// Converts a position and a direction to text. e.g.: [2,4,5], 'n' -> '2_4_5_n'\n\t\n\tfunction posDirToText(pos, direction) {\n\t    return posToText(pos) + '_' + direction;\n\t}\n\t\n\t// Returns eclidean distance between 2 positions\n\t\n\tfunction posDist(p1, p2) {\n\t    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2) + Math.pow(p1[2] - p2[2], 2));\n\t}\n\t\n\t// Returns a rotated direction to the left\n\t\n\tfunction rotLeft(dir) {\n\t    if (dir == 'n') return 'w';else return directions[directions.indexOf(dir) - 1];\n\t}\n\t\n\t// Returns a rotated direction to the right\n\t\n\tfunction rotRight(dir) {\n\t    if (dir == 'w') return 'n';else return directions[directions.indexOf(dir) + 1];\n\t}\n\t\n\t// Returns the oposite direction\n\t\n\tfunction rot180(dir) {\n\t    return rotLeft(rotLeft(dir));\n\t}\n\t\n\tfunction getBounds(obj) {\n\t    return [obj.x, obj.y, obj.width, obj.height];\n\t}\n\n/***/ },\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */\n/*!***********************!*\\\n  !*** ./src/vision.js ***!\n  \\***********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\texports.loadVision = loadVision;\n\texports.resize = resize;\n\t\n\tvar _utilsJs = __webpack_require__(/*! ./utils.js */ 6);\n\t\n\tvar _storeJs = __webpack_require__(/*! ./store.js */ 3);\n\t\n\tfunction setVision() {\n\t    var isResize = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\t\n\t    if (!isResize) _storeJs.state.loadingVision = false;\n\t\n\t    if (_storeJs.state.img) _storeJs.state.img.destroy();\n\t    _storeJs.state.img = _storeJs.state.game.add.image(0, 0, (0, _utilsJs.posDirToText)(_storeJs.state.position, _storeJs.state.direction));\n\t    var r = Math.min(_storeJs.state.game.width / _storeJs.state.img.width, _storeJs.state.game.height / _storeJs.state.img.height);\n\t    _storeJs.state.img.scale.setTo(r);\n\t    _storeJs.state.img.x = (_storeJs.state.game.width - _storeJs.state.img.width) / 2;\n\t    _storeJs.state.img.y = (_storeJs.state.game.height - _storeJs.state.img.height) / 2;\n\t\n\t    // Round bounds\n\t    var bounds = ['x', 'y', 'width', 'height'];\n\t    bounds.map(function (key) {\n\t        return _storeJs.state.img[key] = Math.round(_storeJs.state.img[key]);\n\t    });\n\t\n\t    // Enable mouse move\n\t    if (_storeJs.state.onTap) {\n\t        _storeJs.state.img.inputEnabled = true;\n\t        _storeJs.state.img.events.onInputUp.add(_storeJs.state.onTap, this);\n\t    }\n\t}\n\t\n\tfunction loadVision(state) {\n\t    var s = (0, _utilsJs.posDirToText)(state.position, state.direction);\n\t    if (!state.game.cache.checkImageKey(s)) {\n\t        state.loadingVision = true;\n\t        state.game.load.image(s, 'assets/map/' + s + '.jpg').onFileComplete.add(function () {\n\t            return setVision();\n\t        });\n\t        state.game.load.start();\n\t    } else {\n\t        setVision();\n\t    }\n\t}\n\t\n\tfunction resize() {\n\t    _storeJs.state.game.scale.setGameSize(window.innerWidth, window.innerHeight);\n\t    setVision(true);\n\t}\n\t\n\t// Resizes game on window resize\n\t// based on: http://www.html5gamedevs.com/topic/13900-doubt-about-making-my-game-responsive-on-onresize/\n\t// The delay is supposed to help on some devices\n\twindow.addEventListener('resize', function () {\n\t    return _storeJs.state.game.time.events.add(200, resize);\n\t}, false);\n\n/***/ },\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */\n/*!***************************!*\\\n  !*** ./assets/map/map.js ***!\n  \\***************************/\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar map = { \"1_2_0\": { \"s\": [1, 1, 0] }, \"1_1_0\": { \"s\": [1, 0, 0], \"n\": [1, 2, 0] }, \"1_0_0\": { \"n\": [1, 1, 0], \"w\": [0, 0, 0] }, \"0_0_0\": { \"e\": [1, 0, 0] } };\n\texports[\"default\"] = map;\n\tmodule.exports = exports[\"default\"];\n\n/***/ },\n/* 23 */\n/*!**********************!*\\\n  !*** ./src/input.js ***!\n  \\**********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\t\n\texports.initKeyboardInput = initKeyboardInput;\n\texports.initMouseInput = initMouseInput;\n\t\n\tvar _utilsJs = __webpack_require__(/*! ./utils.js */ 6);\n\t\n\tvar _storeJs = __webpack_require__(/*! ./store.js */ 3);\n\t\n\tfunction initKeyboardInput(fMove, fInteract) {\n\t    var _this = this;\n\t\n\t    var cursors = ['UP', 'DOWN', 'LEFT', 'RIGHT'];\n\t    cursors.map(function (key) {\n\t        return _storeJs.state.game.input.keyboard.addKey(Phaser.Keyboard[key]).onDown.add(fMove, _this, null, key);\n\t    });\n\t\n\t    _storeJs.state.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR).onDown.add(fInteract, this, null);\n\t}\n\t\n\tfunction initMouseInput(fMove, fInteract) {\n\t    _storeJs.state.onTap = function (manager, pointer) {\n\t        return onTap(pointer, fMove, fInteract);\n\t    };\n\t}\n\t\n\tfunction onTap(pointer, fMove, fInteract) {\n\t    var x = pointer.x;\n\t    var y = pointer.y;\n\t\n\t    // The image is divided in 5 areas: top, bottom, left, right and\n\t    // center. A bigger p makes the center smaller and the other areas\n\t    // bigger but more narrow.\n\t    var p = 0.28;\n\t\n\t    var _getBounds = (0, _utilsJs.getBounds)(_storeJs.state.img);\n\t\n\t    var _getBounds2 = _slicedToArray(_getBounds, 4);\n\t\n\t    var ix = _getBounds2[0];\n\t    var iy = _getBounds2[1];\n\t    var iw = _getBounds2[2];\n\t    var ih = _getBounds2[3];\n\t\n\t    var ty = iy + ih * p;\n\t    var by = iy + ih * (1 - p);\n\t    var lx = ix + iw * p;\n\t    var rx = ix + iw * (1 - p);\n\t    // var area = null\n\t\n\t    // Left, Right or Middle\n\t    if (y > ty && y < by) {\n\t        if (x < lx) fMove(null, 'LEFT'); //area = 'left'\n\t        else if (x > rx) fMove(null, 'RIGHT'); //area = 'right'\n\t            else fInteract(); //area = 'center'\n\t        // Tor or Bottom\n\t    } else if (x > lx && x < rx) {\n\t            if (y < ty) fMove(null, 'UP'); //area = 'top'\n\t            else if (y > by) fMove(null, 'DOWN'); //area = 'bottom'\n\t        }\n\t}\n\n/***/ },\n/* 24 */\n/*!***********************!*\\\n  !*** ./src/loader.js ***!\n  \\***********************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\texports.mainLoad = mainLoad;\n\t\n\tvar _utilsJs = __webpack_require__(/*! ./utils.js */ 6);\n\t\n\tvar _movementJs = __webpack_require__(/*! ./movement.js */ 25);\n\t\n\tvar _inputJs = __webpack_require__(/*! ./input.js */ 23);\n\t\n\tvar _storeJs = __webpack_require__(/*! ./store.js */ 3);\n\t\n\tvar _visionJs = __webpack_require__(/*! ./vision.js */ 15);\n\t\n\tfunction mainLoad() {\n\t    _storeJs.state.game.load.onLoadComplete.add(function () {\n\t        _storeJs.state.game.load.onLoadComplete.removeAll();\n\t        mainInit();\n\t    }, this);\n\t\n\t    var firstImg = (0, _utilsJs.posDirToText)(_storeJs.state.position, _storeJs.state.direction);\n\t    _storeJs.state.game.load.image(firstImg, 'assets/map/' + firstImg + '.jpg');\n\t\n\t    _storeJs.state.game.load.start();\n\t    console.log('Loading...');\n\t}\n\t\n\t// First init called. Should be called only once, and before any level.\n\tfunction mainInit() {\n\t    console.log('Done loading');\n\t\n\t    _storeJs.state.game.stage.backgroundColor = '#000000';\n\t\n\t    (0, _inputJs.initKeyboardInput)(_movementJs.move, function () {\n\t        return true;\n\t    });\n\t    (0, _inputJs.initMouseInput)(_movementJs.move, function () {\n\t        return true;\n\t    });\n\t\n\t    (0, _visionJs.resize)();\n\t}\n\n/***/ },\n/* 25 */\n/*!*************************!*\\\n  !*** ./src/movement.js ***!\n  \\*************************/\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t    value: true\n\t});\n\texports.move = move;\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _assetsMapMapJs = __webpack_require__(/*! ../assets/map/map.js */ 22);\n\t\n\tvar _assetsMapMapJs2 = _interopRequireDefault(_assetsMapMapJs);\n\t\n\tvar _utilsJs = __webpack_require__(/*! ./utils.js */ 6);\n\t\n\tvar _visionJs = __webpack_require__(/*! ./vision.js */ 15);\n\t\n\tvar _storeJs = __webpack_require__(/*! ./store.js */ 3);\n\t\n\tvar walk = {\n\t    e: [1, 0, 0],\n\t    s: [0, -1, 0],\n\t    w: [-1, 0, 0],\n\t    n: [0, 1, 0]\n\t};\n\t\n\tfunction tryChangePos(direction) {\n\t    var newPos = _assetsMapMapJs2['default'][(0, _utilsJs.posToText)(_storeJs.state.position)][direction];\n\t    if (newPos) {\n\t        _storeJs.state.position = newPos;\n\t        return true;\n\t    }\n\t    return false;\n\t}\n\t\n\tfunction move(event, key) {\n\t    if (!_storeJs.state.loadingVision) {\n\t        var moved = false;\n\t        var rotated = false;\n\t        switch (key) {\n\t            case 'UP':\n\t                moved = tryChangePos(_storeJs.state.direction);\n\t                break;\n\t            case 'DOWN':\n\t                moved = tryChangePos((0, _utilsJs.rot180)(_storeJs.state.direction));\n\t                break;\n\t            case 'LEFT':\n\t                rotatePlayer(_storeJs.state, 'left');\n\t                rotated = true;\n\t                break;\n\t            case 'RIGHT':\n\t                rotatePlayer(_storeJs.state, 'right');\n\t                rotated = true;\n\t                break;\n\t        }\n\t        if (rotated || moved) (0, _visionJs.loadVision)(_storeJs.state);\n\t        if (moved && _storeJs.state.onMoved) _storeJs.state.onMoved();\n\t    }\n\t}\n\t\n\tfunction rotatePlayer(state, type) {\n\t    if (type == 'left') state.direction = (0, _utilsJs.rotLeft)(state.direction);else state.direction = (0, _utilsJs.rotRight)(state.direction);\n\t}\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** app.js\n **/","import {mainLoad} from './loader.js'\nimport {state} from './store.js'\n\nfunction create() {\n    mainLoad()\n}\n\nstate.game = new Phaser.Game(0, 0, Phaser.AUTO, 'app',\n                           { create: create })\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","export var state = {\n    position: [1, 2, 0],\n    direction: 'w',\n    // if is waiting the load of an image for the vision\n    loadingVision: false,\n}\n\nwindow.s = state\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/store.js\n **/","var directions = ['n', 'e', 's', 'w']\n\n// Return a random int from 0 to x-1\nexport function randInt(x) {\n    return Math.floor(Math.random() * (x))\n}\n\n// Check if two arrays have the same numbers in the same order\nexport function equalArrays(a1, a2) {\n    var equal = true\n    for (let i in a1) {\n        if (a1[i] != a2[i]) {\n            equal = false\n            break\n        }\n    }\n    return equal\n}\n\n// Converts a text to a position. e.g.: '2_4_5' -> [2,4,5]\nexport function textToPos(t) {\n    return t.split('_').map((x)=>parseInt(x))\n}\n\n// Converts a position to text. e.g.: [2,4,5] -> '2_4_5'\nexport function posToText(pos) {\n    return pos.join('_')\n}\n\n// Converts a position and a direction to text. e.g.: [2,4,5], 'n' -> '2_4_5_n'\nexport function posDirToText(pos, direction) {\n    return posToText(pos) + '_' + direction\n}\n\n// Returns eclidean distance between 2 positions\nexport function posDist(p1, p2) {\n    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) +\n                     Math.pow(p1[1] - p2[1], 2) +\n                     Math.pow(p1[2] - p2[2], 2))\n}\n\n// Returns a rotated direction to the left\nexport function rotLeft(dir) {\n    if (dir == 'n') return 'w'\n    else return directions[directions.indexOf(dir) - 1]\n}\n\n// Returns a rotated direction to the right\nexport function rotRight(dir) {\n    if (dir == 'w') return 'n'\n    else return directions[directions.indexOf(dir) + 1]\n}\n\n// Returns the oposite direction\nexport function rot180(dir) {\n    return rotLeft(rotLeft(dir))\n}\n\nexport function getBounds(obj) {\n    return [obj.x, obj.y, obj.width, obj.height]\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.js\n **/","import {posDirToText, getBounds} from './utils.js'\nimport {state} from './store.js'\n\n\nfunction setVision(isResize=false) {\n    if (!isResize) state.loadingVision = false\n\n    if (state.img) state.img.destroy()\n    state.img = state.game.add.image(0, 0, posDirToText(state.position, state.direction))\n    var r = Math.min(state.game.width/state.img.width, state.game.height/state.img.height)\n    state.img.scale.setTo(r)\n    state.img.x = (state.game.width - state.img.width) / 2\n    state.img.y = (state.game.height - state.img.height) / 2\n\n    // Round bounds\n    var bounds = ['x', 'y', 'width', 'height']\n    bounds.map((key) => state.img[key] = Math.round(state.img[key]))\n\n    // Enable mouse move\n    if (state.onTap) {\n        state.img.inputEnabled = true\n        state.img.events.onInputUp.add(state.onTap, this)\n    }\n}\n\nexport function loadVision(state) {\n    var s = posDirToText(state.position, state.direction)\n    if (!state.game.cache.checkImageKey(s)) {\n        state.loadingVision = true\n        state.game.load.image(s, 'assets/map/' + s + '.jpg').onFileComplete.add(() => setVision())\n        state.game.load.start()\n    } else {\n        setVision()\n    }\n}\n\nexport function resize() {\n    state.game.scale.setGameSize(window.innerWidth, window.innerHeight)\n    setVision(true)\n}\n\n// Resizes game on window resize\n// based on: http://www.html5gamedevs.com/topic/13900-doubt-about-making-my-game-responsive-on-onresize/\n// The delay is supposed to help on some devices\nwindow.addEventListener('resize',\n                        () => state.game.time.events.add(200, resize),\n                        false)\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/vision.js\n **/","var map = {\"1_2_0\": {\"s\": [1, 1, 0]}, \"1_1_0\": {\"s\": [1, 0, 0], \"n\": [1, 2, 0]}, \"1_0_0\": {\"n\": [1, 1, 0], \"w\": [0, 0, 0]}, \"0_0_0\": {\"e\": [1, 0, 0]}}\nexport default map\n\n\n/** WEBPACK FOOTER **\n ** ./assets/map/map.js\n **/","import {getBounds} from './utils.js'\nimport {state} from './store.js'\n\n\nexport function initKeyboardInput(fMove, fInteract) {\n    var cursors = ['UP', 'DOWN', 'LEFT', 'RIGHT']\n    cursors.map(\n        (key) => state.game.input.keyboard.addKey(\n            Phaser.Keyboard[key]).onDown.add(fMove, this, null, key))\n\n    state.game.input.keyboard.addKey(\n        Phaser.Keyboard.SPACEBAR).onDown.add(fInteract, this, null)\n}\n\nexport function initMouseInput(fMove, fInteract) {\n    state.onTap = (manager, pointer) => onTap(pointer, fMove, fInteract)\n}\n\nfunction onTap(pointer, fMove, fInteract) {\n    var x = pointer.x\n    var y = pointer.y\n\n    // The image is divided in 5 areas: top, bottom, left, right and\n    // center. A bigger p makes the center smaller and the other areas\n    // bigger but more narrow.\n    var p = 0.28\n    var [ix, iy, iw, ih] = getBounds(state.img)\n    var ty = iy + ih * p\n    var by = iy + ih * (1-p)\n    var lx = ix + iw * p\n    var rx = ix + iw * (1-p)\n    // var area = null\n\n    // Left, Right or Middle\n    if (y > ty && y < by) {\n        if (x < lx) fMove(null, 'LEFT') //area = 'left'\n        else if (x > rx) fMove(null, 'RIGHT') //area = 'right'\n        else fInteract() //area = 'center'\n        // Tor or Bottom\n    } else if (x > lx && x < rx) {\n        if (y < ty) fMove(null, 'UP') //area = 'top'\n        else if (y > by) fMove(null, 'DOWN') //area = 'bottom'\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/input.js\n **/","import {posDirToText} from './utils.js'\nimport {move} from './movement.js'\nimport {initKeyboardInput, initMouseInput} from './input.js'\nimport {state} from './store.js'\nimport {resize} from './vision.js'\n\n\nexport function mainLoad() {\n    state.game.load.onLoadComplete.add(function () {\n            state.game.load.onLoadComplete.removeAll()\n            mainInit()\n    }, this)\n\n    var firstImg = posDirToText(state.position, state.direction)\n    state.game.load.image(firstImg, `assets/map/${firstImg}.jpg`)\n\n    state.game.load.start()\n    console.log('Loading...')\n}\n\n// First init called. Should be called only once, and before any level.\nfunction mainInit() {\n    console.log('Done loading')\n\n    state.game.stage.backgroundColor = '#000000'\n\n    initKeyboardInput(move, () => true)\n    initMouseInput(move, () => true)\n\n    resize()\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/loader.js\n **/","import map from '../assets/map/map.js'\nimport {randInt, posToText, posDist, getBounds, rotLeft, rotRight, rot180} from './utils.js'\nimport {loadVision} from './vision.js'\nimport {state} from './store.js'\n\n\nvar walk = {\n    e: [1, 0, 0],\n    s: [0, -1, 0],\n    w: [-1, 0, 0],\n    n: [0, 1, 0],\n}\n\n\nfunction tryChangePos(direction) {\n    let newPos = map[posToText(state.position)][direction]\n    if (newPos) {\n        state.position = newPos\n        return true\n    }\n    return false\n}\n\nexport function move(event, key) {\n    if (!state.loadingVision) {\n        var moved = false\n        var rotated = false\n        switch (key) {\n        case 'UP':\n            moved = tryChangePos(state.direction)\n            break\n        case 'DOWN':\n            moved = tryChangePos(rot180(state.direction))\n            break\n        case 'LEFT':\n            rotatePlayer(state, 'left')\n            rotated = true\n            break\n        case 'RIGHT':\n            rotatePlayer(state, 'right')\n            rotated = true\n            break\n        }\n        if (rotated || moved) loadVision(state)\n        if (moved && state.onMoved) state.onMoved()\n    }\n}\n\nfunction rotatePlayer(state, type) {\n    if (type == 'left') state.direction = rotLeft(state.direction)\n    else state.direction = rotRight(state.direction)\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/movement.js\n **/"],"sourceRoot":""}